# ğŸ¤– AI Code Review è¨­ç½®æŒ‡å—

æœ¬å°ˆæ¡ˆä½¿ç”¨ **Claude 3.5 Sonnet** ä½œç‚º AI Code Review Agentï¼Œè‡ªå‹•åˆ†ææ¯å€‹ Pull Request ä¸¦æä¾›å°ˆæ¥­çš„ç¨‹å¼ç¢¼å¯©æŸ¥å»ºè­°ã€‚

---

## ğŸ“‹ åŠŸèƒ½ç‰¹æ€§

AI Code Review Agent æœƒè‡ªå‹•åˆ†æï¼š

- âœ… **ç¨‹å¼ç¢¼å“è³ª** - å¯è®€æ€§ã€ç¶­è­·æ€§ã€å‘½åè¦ç¯„
- âœ… **æ½›åœ¨å•é¡Œ** - é‚è¼¯éŒ¯èª¤ã€é‚Šç•Œæ¢ä»¶ã€éŒ¯èª¤è™•ç†
- âœ… **å®‰å…¨æ€§** - å®‰å…¨æ¼æ´ã€æ•æ„Ÿè³‡è¨Šã€è¼¸å…¥é©—è­‰
- âœ… **æ€§èƒ½** - æ€§èƒ½ç“¶é ¸ã€å„ªåŒ–å»ºè­°
- âœ… **æ¸¬è©¦** - æ¸¬è©¦è¦†è“‹ç‡ã€æ¸¬è©¦å“è³ª
- âœ… **æœ€ä½³å¯¦è¸** - è¨­è¨ˆæ¨¡å¼ã€ç¾ä»£åŒ–å¯«æ³•
- âœ… **æ–‡æª”** - è¨»é‡‹ã€API æ–‡æª”ã€README

---

## ğŸ”§ è¨­ç½®æ­¥é©Ÿ

### 1. ç²å– Anthropic API Key

1. å‰å¾€ [Anthropic Console](https://console.anthropic.com/)
2. ç™»å…¥æˆ–è¨»å†Šå¸³è™Ÿ
3. é€²å…¥ **API Keys** é é¢
4. é»æ“Š **Create Key** å‰µå»ºæ–°çš„ API key
5. è¤‡è£½ç”Ÿæˆçš„ API keyï¼ˆæ ¼å¼ï¼š`sk-ant-api03-...`ï¼‰

### 2. è¨­ç½® GitHub Secret

1. å‰å¾€ä½ çš„ GitHub repository
2. é»æ“Š **Settings** â†’ **Secrets and variables** â†’ **Actions**
3. é»æ“Š **New repository secret**
4. è¨­ç½®ï¼š
   - **Name**: `ANTHROPIC_API_KEY`
   - **Secret**: è²¼ä¸Šä½ çš„ Anthropic API key
5. é»æ“Š **Add secret**

### 3. å®‰è£ Claude SDK ä¾è³´

åœ¨ `package.json` ä¸­æ·»åŠ ä¾è³´ï¼š

\`\`\`json
{
  "dependencies": {
    "@anthropic-ai/sdk": "^0.27.0"
  }
}
\`\`\`

ç„¶å¾ŒåŸ·è¡Œï¼š
\`\`\`bash
npm install
\`\`\`

---

## ğŸš€ ä½¿ç”¨æ–¹å¼

### è‡ªå‹•è§¸ç™¼

ä¸€æ—¦è¨­ç½®å®Œæˆï¼ŒAI Code Review æœƒåœ¨ä»¥ä¸‹æƒ…æ³**è‡ªå‹•åŸ·è¡Œ**ï¼š

- âœ… å‰µå»ºæ–°çš„ Pull Request
- âœ… å‘ PR æ¨é€æ–°çš„ commits

### é‹è¡Œæµç¨‹

1. **GitHub Actions è§¸ç™¼** (`.github/workflows/ai-code-review.yml`)
2. **ç²å– PR è³‡æ–™** - ä½¿ç”¨ MCP GitHubClient
   - PR åŸºæœ¬è³‡è¨Š
   - æ–‡ä»¶è®Šæ›´å’Œ diff
   - ç¾æœ‰è©•è«–
3. **Claude AI åˆ†æ** - èª¿ç”¨ Claude 3.5 Sonnet API
   - æ·±åº¦ç¨‹å¼ç¢¼åˆ†æ
   - ç”Ÿæˆå°ˆæ¥­å»ºè­°
4. **ç™¼å¸ƒè©•è«–** - è‡ªå‹•åœ¨ PR ä¸­ç™¼å¸ƒ AI å¯©æŸ¥çµæœ

### æŸ¥çœ‹çµæœ

AI å¯©æŸ¥å®Œæˆå¾Œï¼Œä½ æœƒåœ¨ PR ä¸­çœ‹åˆ°ä¸€å‰‡è©•è«–ï¼š

```
ğŸ¤– AI Code Review by Claude

[è©³ç´°çš„ç¨‹å¼ç¢¼å¯©æŸ¥å…§å®¹]

---
å¯©æŸ¥æ¨¡å‹: Claude 3.5 Sonnet
å¯©æŸ¥æ™‚é–“: 2025-10-09 ...
è‡ªå‹•åŒ–å·¥å…·: GitHub MCP + Claude API
```

---

## ğŸ§ª æœ¬åœ°æ¸¬è©¦

ä½ ä¹Ÿå¯ä»¥åœ¨æœ¬åœ°æ‰‹å‹•é‹è¡Œ AI Code Reviewï¼š

\`\`\`bash
# è¨­ç½®ç’°å¢ƒè®Šæ•¸
export ANTHROPIC_API_KEY="your-api-key"
export GITHUB_ACCESS_TOKEN="your-github-token"
export GITHUB_REPOSITORY="owner/repo"
export PR_NUMBER="1"

# åŸ·è¡Œ AI å¯©æŸ¥
node ai-code-reviewer.js
\`\`\`

---

## ğŸ“Š å·¥ä½œåŸç†

### æ¶æ§‹åœ–

\`\`\`
PR å‰µå»º/æ›´æ–°
    â†“
GitHub Actions è§¸ç™¼
    â†“
ai-code-reviewer.js åŸ·è¡Œ
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. ä½¿ç”¨ MCP         â”‚
â”‚    GitHubClient     â”‚
â”‚    ç²å– PR è³‡æ–™     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 2. æ§‹å»ºè©³ç´°çš„       â”‚
â”‚    åˆ†æ Prompt      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 3. èª¿ç”¨ Claude API  â”‚
â”‚    é€²è¡Œæ·±åº¦åˆ†æ     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 4. ç™¼å¸ƒ AI è©•è«–     â”‚
â”‚    åˆ° PR            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
\`\`\`

### æ ¸å¿ƒçµ„ä»¶

1. **ai-code-reviewer.js**
   - ä¸»è¦çš„ AI å¯©æŸ¥è…³æœ¬
   - ä½¿ç”¨ `GitHubClient` ç²å– PR æ•¸æ“š
   - èª¿ç”¨ Claude API é€²è¡Œåˆ†æ
   - ç™¼å¸ƒå¯©æŸ¥è©•è«–

2. **.github/workflows/ai-code-review.yml**
   - GitHub Actions workflow é…ç½®
   - å®šç¾©è§¸ç™¼æ¢ä»¶å’ŒåŸ·è¡Œæ­¥é©Ÿ

3. **GitHubClient (MCP)**
   - å°è£ GitHub API èª¿ç”¨
   - æä¾› PR è³‡æ–™ç²å–æ–¹æ³•

---

## âš™ï¸ è‡ªå®šç¾©é…ç½®

### èª¿æ•´ AI å¯©æŸ¥é‡é»

ç·¨è¼¯ `ai-code-reviewer.js` ä¸­çš„ `buildPrompt` å‡½æ•¸ï¼Œä¿®æ”¹å¯©æŸ¥ç¶­åº¦ï¼š

\`\`\`javascript
## è«‹ä½ æä¾›ä»¥ä¸‹æ–¹é¢çš„å¯©æŸ¥ï¼š

1. **ä½ çš„è‡ªå®šç¾©å¯©æŸ¥é …ç›®** ğŸ¯
   - å…·é«”è¦æ±‚...
\`\`\`

### èª¿æ•´ AI æ¨¡å‹åƒæ•¸

åœ¨ `analyzeWithClaude` å‡½æ•¸ä¸­èª¿æ•´ï¼š

\`\`\`javascript
const message = await anthropic.messages.create({
  model: 'claude-3-5-sonnet-20241022',
  max_tokens: 4096,        // èª¿æ•´å›æ‡‰é•·åº¦
  temperature: 0.3,        // èª¿æ•´å‰µé€ æ€§ (0-1)
  // ...
});
\`\`\`

### ä¿®æ”¹è§¸ç™¼æ¢ä»¶

ç·¨è¼¯ `.github/workflows/ai-code-review.yml`ï¼š

\`\`\`yaml
on:
  pull_request:
    types: [opened, synchronize, reopened]  # æ·»åŠ æ›´å¤šè§¸ç™¼é¡å‹
    paths:                                   # åªé‡å°ç‰¹å®šæ–‡ä»¶
      - 'src/**'
      - '!*.md'
\`\`\`

---

## ğŸ’° è²»ç”¨èªªæ˜

### Anthropic API å®šåƒ¹

Claude 3.5 Sonnet (20241022) å®šåƒ¹ï¼š
- **Input**: $3.00 / 1M tokens
- **Output**: $15.00 / 1M tokens

### ä¼°ç®—

ä¸€èˆ¬çš„ PR å¯©æŸ¥ï¼š
- Input tokens: ~5,000-10,000 (PR è³‡æ–™ + prompt)
- Output tokens: ~2,000-4,000 (AI å¯©æŸ¥å…§å®¹)
- **æ¯æ¬¡å¯©æŸ¥æˆæœ¬**: ~$0.05-0.15 USD

å»ºè­°è¨­ç½®æ¯æœˆé ç®—ä¸Šé™ã€‚

---

## ğŸ”’ å®‰å…¨æœ€ä½³å¯¦è¸

1. âœ… **æ°¸é ä¸è¦åœ¨ç¨‹å¼ç¢¼ä¸­ç¡¬ç·¨ç¢¼ API keys**
2. âœ… **ä½¿ç”¨ GitHub Secrets å­˜å„²æ•æ„Ÿè³‡è¨Š**
3. âœ… **å®šæœŸè¼ªæ› API keys**
4. âœ… **ç›£æ§ API ä½¿ç”¨é‡å’Œè²»ç”¨**
5. âœ… **é™åˆ¶ workflow æ¬Šé™**ï¼ˆåªçµ¦å¿…è¦çš„æ¬Šé™ï¼‰

---

## ğŸ› æ•…éšœæ’é™¤

### AI å¯©æŸ¥æ²’æœ‰é‹è¡Œ

**æª¢æŸ¥**:
1. GitHub Secret `ANTHROPIC_API_KEY` æ˜¯å¦æ­£ç¢ºè¨­ç½®
2. Workflow æ–‡ä»¶æ˜¯å¦åœ¨ `master` åˆ†æ”¯
3. Actions é é¢æŸ¥çœ‹éŒ¯èª¤æ—¥èªŒ

### API éŒ¯èª¤

**å¸¸è¦‹éŒ¯èª¤**:
- `401 Unauthorized`: API key ç„¡æ•ˆæˆ–éæœŸ
- `429 Too Many Requests`: è¶…éé€Ÿç‡é™åˆ¶
- `500 Internal Server Error`: Anthropic æœå‹™å•é¡Œ

**è§£æ±ºæ–¹æ³•**:
- æª¢æŸ¥ API key æ˜¯å¦æ­£ç¢º
- æ¸›å°‘è«‹æ±‚é »ç‡
- æŸ¥çœ‹ Anthropic ç‹€æ…‹é é¢

### è©•è«–æœªç™¼å¸ƒ

**æª¢æŸ¥**:
- GitHub Actions æ˜¯å¦æœ‰ `pull-requests: write` æ¬Šé™
- `GITHUB_TOKEN` æ˜¯å¦æœ‰æ•ˆ
- PR æ˜¯å¦å·²é—œé–‰

---

## ğŸ“š å»¶ä¼¸é–±è®€

- [Anthropic API æ–‡æª”](https://docs.anthropic.com/claude/reference/getting-started-with-the-api)
- [Claude 3.5 Sonnet æ¨¡å‹èªªæ˜](https://www.anthropic.com/claude)
- [GitHub Actions æ–‡æª”](https://docs.github.com/en/actions)
- [GitHub MCP æ–‡æª”](./README.md)

---

## ğŸ‰ å®Œæˆï¼

ç¾åœ¨æ¯å€‹ PR éƒ½æœƒè‡ªå‹•ç²å¾— AI çš„å°ˆæ¥­å¯©æŸ¥å»ºè­°ï¼Œå¹«åŠ©ä½ ï¼š
- âœ… æå‡ç¨‹å¼ç¢¼å“è³ª
- âœ… ç™¼ç¾æ½›åœ¨å•é¡Œ
- âœ… å­¸ç¿’æœ€ä½³å¯¦è¸
- âœ… åŠ å¿«å¯©æŸ¥æµç¨‹

ğŸ’¡ **æç¤º**: AI å¯©æŸ¥æ˜¯è¼”åŠ©å·¥å…·ï¼Œä»å»ºè­°çµåˆäººå·¥å¯©æŸ¥ä»¥ç¢ºä¿æœ€ä½³çµæœï¼
